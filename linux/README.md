# LINUX

#### Как пересылать файлы по ssh не используя scp

Чтобы отправить

```cat /local/path/to/my_file | ssh login@server.com "cat > /remote/path/to/my_file"```

или

```ssh login@server.com "cat > /remote/path/to/my_file" < /local/path/to/my_file```



Чтобы получить:

```ssh login@server.com "cat /remote/path/to/my_file" > /local/path/to/my_file```

-------------------------------------------------------------------------------

#### Нехватка innode на сервере

Очень редко бывает так, что на сервере могут кончиться innode файловой системы, хотя команда ```df -h``` будет показывать наличие свободного места, при попытке создания нового файла будет ошибка ```No space left on device```. Чтобы убедиться, что проблема именно в нехватке innode, выполните команду ```df -i```, столбец ```IUse%``` наглядно показывает результат в процентах.
Если ```IUse%``` >90%, то желательно разобраться, где источник наибольшей концентрации файлов(может быть так, что это логи какого-либо приложения или временные файлы).

Для этого выполните bash команду: ```for ii in $(find -maxdepth 1 -type d); do echo -e "${ii}\t$(find "${ii}" -type l -o -type d -o -type f | wc -l)"; done | sort -n -k 2 -r | column -t```

Данная команда посчитает использование innode в текущей директории.

Вывод будет в следующем формате:
```
.            2556
./.composer  1741
./.cache     632
./.config    161
./.ssh       7
./.local     5
```


-------------------------------------------------------------------------------

Пожалуй самая полная статья про потоки ввода/вывода.

http://xgu.ru/wiki/stdin

-------------------------------------------------------------------------------

#### Проброс IP из локальной сети сервера на локальный компьютер средствами SSH

Допустим, в локальной сети сервера `1.2.3.4` есть машина с IP `192.168.0.222` у которой на `7777` порту поднят какой-либо сервис. Нам необходимо иметь доступ до этого сервиса на `127.0.0.1:7777`.

Команда будет выглядеть следующим образом:

```bash
ssh -f -N -L 2000:192.168.0.222:7777 root@1.2.3.4
```

-------------------------------------------------------------------------------

#### Распаковка поддиректории второго уровня tar.gz архива в директорию системы
```
tar -C /destenation/path -xvf /path/to/archive.tar.gz --strip-components=2 path/inside_archive
```

#### Запуск комманды в единственном экземпляре через cron
```
run-one
```
http://manpages.ubuntu.com/manpages/xenial/man1/run-one.1.html
